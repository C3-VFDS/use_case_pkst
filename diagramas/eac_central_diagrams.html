<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Backend EAC â€” Nodo Central</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
    html, body, #root { height: 100%; }
    body { overflow-x: hidden; }
    ::-webkit-scrollbar { width: 6px; height: 6px; }
    ::-webkit-scrollbar-track { background: rgba(255,255,255,0.04); }
    ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.15); border-radius: 3px; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useRef, useEffect } = React;

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // SHARED PRIMITIVES
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const METHOD_COLORS = {
      GET:    { bg: "#e3f2fd", text: "#1565c0", border: "#1565c0" },
      POST:   { bg: "#e8f5e9", text: "#2e7d32", border: "#2e7d32" },
      PUT:    { bg: "#fff8e1", text: "#f57f17", border: "#f57f17" },
      DELETE: { bg: "#ffebee", text: "#c62828", border: "#c62828" },
      PATCH:  { bg: "#f3e5f5", text: "#6a1b9a", border: "#6a1b9a" },
    };

    const CONSUMERS = {
      CONNECTOR_CENTRAL: { label: "CONNECTOR_CENTRAL", color: "#e91e63", bg: "#fce4ec", textColor: "#880e4f" },
      REC:     { label: "Recommendation Engine",  color: "#1976d2", bg: "#e3f2fd", textColor: "#0d47a1" },
      RUBRIC:  { label: "Rubric Evaluator",        color: "#e65100", bg: "#fff3e0", textColor: "#bf360c" },
      PGEN:    { label: "Problem Generator",       color: "#7b1fa2", bg: "#f3e5f5", textColor: "#4a148c" },
      KSB:     { label: "Knowledge Space Builder", color: "#00695c", bg: "#e0f2f1", textColor: "#004d40" },
      SGRAPH:  { label: "Skill Graph Manager",     color: "#283593", bg: "#e8eaf6", textColor: "#1a237e" },
      SYNTH:   { label: "Synthetic Data Gen.",     color: "#558b2f", bg: "#f1f8e9", textColor: "#33691e" },
      ORIONLD: { label: "Orion-LD",               color: "#00838f", bg: "#e0f7fa", textColor: "#006064" },
      POSTGRES:{ label: "PostgreSQL",              color: "#4e342e", bg: "#efebe9", textColor: "#3e2723" },
      LLM:     { label: "LLM API (Claude/GPT-4)", color: "#f57f17", bg: "#fffde7", textColor: "#e65100" },
      OPERATOR:{ label: "Operador (externo)",      color: "#546e7a", bg: "#eceff1", textColor: "#263238" },
      PROMETHEUS:{ label: "Prometheus",            color: "#d84315", bg: "#fbe9e7", textColor: "#bf360c" },
    };

    function MethodBadge({ method }) {
      const c = METHOD_COLORS[method] || METHOD_COLORS.GET;
      return (
        <span style={{
          display: "inline-block", padding: "1px 7px", borderRadius: "3px",
          fontSize: "10px", fontWeight: "800",
          background: c.bg, color: c.text, border: `1.5px solid ${c.border}`,
          fontFamily: "'DM Mono', monospace", letterSpacing: "0.05em", flexShrink: 0,
        }}>{method}</span>
      );
    }

    function ConsumerBadge({ id }) {
      const c = CONSUMERS[id];
      if (!c) return null;
      return (
        <span style={{
          display: "inline-block", padding: "2px 8px", borderRadius: "12px",
          fontSize: "10.5px", fontWeight: "600",
          background: c.bg, color: c.textColor, border: `1px solid ${c.color}`,
          marginRight: "4px", marginBottom: "3px", whiteSpace: "nowrap",
          letterSpacing: "0.01em", fontFamily: "'DM Mono', monospace",
        }}>{c.label}</span>
      );
    }

    function InfraTag({ id }) {
      const c = CONSUMERS[id];
      if (!c) return null;
      return (
        <span style={{
          display: "inline-flex", alignItems: "center", gap: "3px",
          padding: "2px 7px", borderRadius: "4px",
          fontSize: "10px", fontWeight: "700",
          background: c.bg, color: c.textColor, border: `1px solid ${c.color}`,
          marginRight: "4px", marginBottom: "2px", fontFamily: "'DM Mono', monospace",
        }}>{id}</span>
      );
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TAB 1 â€” MÃ“DULOS Y ENDPOINTS (eac_modules)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const MODULES_DATA = [
      {
        id: "KSB", icon: "ğŸ“", title: "Knowledge Space Builder",
        subtitle: "ConstrucciÃ³n y mantenimiento del Grafo de Precedencia",
        color: "#00695c", bg: "#e0f2f1", border: "#80cbc4",
        description: "Parsea la estructura curricular (Ciclos â†’ MÃ³dulos â†’ RA â†’ CE â†’ SC) y construye el DAG de habilidades. Detecta ciclos y habilidades huÃ©rfanas. Integra trazas del Synthetic Data Generator.",
        tech: "NetworkX Â· Neo4j (opt.)",
        endpoints: [
          { method: "POST", path: "/api/v2/graph/build",     desc: "Construye el grafo completo desde datos curriculares",      consumes: ["OPERATOR"],       produces: "DAG de SC + Nodos de Requisito" },
          { method: "PUT",  path: "/api/v2/graph/enrich",    desc: "Enriquece el grafo con trazas sintÃ©ticas",                  consumes: ["SYNTH"],          produces: "Grafo actualizado" },
          { method: "GET",  path: "/api/v2/graph/curriculum",desc: "Devuelve la estructura completa del grafo",                 consumes: ["PGEN","SGRAPH"],  produces: "DAG serializado (JSON)" },
          { method: "GET",  path: "/api/v2/graph/validate",  desc: "Valida coherencia del grafo (ciclos, orfandades)",          consumes: ["OPERATOR"],       produces: "Informe de validaciÃ³n" },
          { method: "POST", path: "/api/v2/graph/nodes",     desc: "AÃ±ade/actualiza nodos individuales del grafo",              consumes: ["OPERATOR"],       produces: "Nodo actualizado" },
        ],
        reads: ["ORIONLD","POSTGRES"], writes: ["ORIONLD","POSTGRES"],
      },
      {
        id: "SGRAPH", icon: "ğŸ•¸ï¸", title: "Skill Graph Manager",
        subtitle: "GestiÃ³n del estado de habilitaciÃ³n de cada estudiante",
        color: "#283593", bg: "#e8eaf6", border: "#9fa8da",
        description: "Mantiene el Perfil de HabilitaciÃ³n individual (nodos completados, Gradiente de AutonomÃ­a). Calcula la Outer Fringe del grafo para cada estudiante. Gestiona la PolitopÃ­a del Ecosistema Laboral.",
        tech: "NetworkX Â· PostgreSQL Â· Orion-LD",
        endpoints: [
          { method: "GET", path: "/api/v2/students/{anon_id}/profile",  desc: "Devuelve el perfil de habilitaciÃ³n completo del estudiante", consumes: ["REC","CONNECTOR_CENTRAL"], produces: "nodos_completados[], gradiente_autonomia" },
          { method: "PUT", path: "/api/v2/students/{anon_id}/profile",  desc: "Actualiza perfil tras evaluaciÃ³n de una SC",                  consumes: ["RUBRIC"],                   produces: "Perfil actualizado" },
          { method: "GET", path: "/api/v2/graph/outer-fringe",          desc: "Calcula la Outer Fringe (Zona de Despliegue Proximal)",        consumes: ["REC"],                      produces: "outer_fringe[] â€” SCs candidatas" },
          { method: "GET", path: "/api/v2/graph/politopia",             desc: "Devuelve estado global del Ecosistema Laboral",                consumes: ["PGEN","REC"],               produces: "PolitopÃ­a serializada" },
          { method: "GET", path: "/api/v2/students/{anon_id}/history",  desc: "Historial de navegaciÃ³n del estudiante por el grafo",          consumes: ["CONNECTOR_CENTRAL"],        produces: "history[] de SCs resueltas" },
        ],
        reads: ["POSTGRES","ORIONLD","KSB"], writes: ["POSTGRES","ORIONLD"],
      },
      {
        id: "REC", icon: "ğŸ¯", title: "Recommendation Engine",
        subtitle: "SelecciÃ³n de la siguiente SC Ã³ptima para el estudiante",
        color: "#1565c0", bg: "#e3f2fd", border: "#90caf9",
        description: "Operacionaliza la Zona de Despliegue Proximal. Selecciona la SC Ã³ptima segÃºn el Gradiente de AutonomÃ­a: si score > 0.85 â†’ dificultad mÃ¡xima; si score < 0.50 â†’ refuerzo de prerequisitos; si intermedio â†’ elecciÃ³n aleatoria de candidatas.",
        tech: "Python Â· NetworkX",
        endpoints: [
          { method: "GET",  path: "/api/v2/students/{anon_id}/recommendation", desc: "Devuelve la SC recomendada para el prÃ³ximo reto",                       consumes: ["CONNECTOR_CENTRAL"], produces: "sc_id, titulo, nivel_dificultad, prerequisitos_cumplidos[]" },
          { method: "GET",  path: "/api/v2/students/{anon_id}/panel",           desc: "Panel completo: perfil + SC recomendada + mÃ©tricas",                   consumes: ["CONNECTOR_CENTRAL"], produces: "perfil_habilitacion[] + SC_recomendada" },
          { method: "POST", path: "/api/v2/recommendation/batch",               desc: "Recomendaciones para un grupo de estudiantes (panel docente)",           consumes: ["CONNECTOR_CENTRAL"], produces: "[ {anon_id, SC_recomendada} ]" },
        ],
        reads: ["SGRAPH","POSTGRES"], writes: [],
      },
      {
        id: "PGEN", icon: "ğŸ¤–", title: "Problem Generator",
        subtitle: "GeneraciÃ³n LLM de Situaciones de Competencia contextualizadas",
        color: "#6a1b9a", bg: "#f3e5f5", border: "#ce93d8",
        description: "Genera enunciados de SC con Claude/GPT-4. Crea rÃºbricas de evaluaciÃ³n multi-criterio. Valida coherencia SC-habilidades. Versiona SCs por dificultad y variantes. Recibe la SC seleccionada del Recommendation Engine o parÃ¡metros directos del docente.",
        tech: "Anthropic SDK Â· OpenAI Â· Pydantic",
        endpoints: [
          { method: "POST", path: "/api/v2/sc/generate",        desc: "Genera una nueva SC dado un anon_id o parÃ¡metros pedagÃ³gicos", consumes: ["CONNECTOR_CENTRAL","REC"],    produces: "sc_id, enunciado, rÃºbrica multi-criterio" },
          { method: "GET",  path: "/api/v2/sc/{sc_id}",         desc: "Recupera una SC por ID (enunciado + rÃºbrica)",                  consumes: ["CONNECTOR_CENTRAL","RUBRIC"], produces: "SC completa con rÃºbrica" },
          { method: "PUT",  path: "/api/v2/sc/{sc_id}/rubric",  desc: "Actualiza/versiona la rÃºbrica de una SC",                       consumes: ["RUBRIC","OPERATOR"],          produces: "RÃºbrica actualizada" },
          { method: "POST", path: "/api/v2/sc/{sc_id}/validate",desc: "Valida coherencia SC â†” habilidades del grafo",                  consumes: ["KSB","OPERATOR"],             produces: "Informe de coherencia" },
          { method: "GET",  path: "/api/v2/sc",                  desc: "Lista SCs disponibles con filtros (mÃ³dulo, nivel, habilidades)", consumes: ["CONNECTOR_CENTRAL"],         produces: "SC[] paginadas" },
        ],
        reads: ["POSTGRES","KSB","LLM"], writes: ["POSTGRES","ORIONLD"],
      },
      {
        id: "RUBRIC", icon: "ğŸ“", title: "Rubric Evaluator",
        subtitle: "EvaluaciÃ³n de evidencias y actualizaciÃ³n del Perfil de HabilitaciÃ³n",
        color: "#bf360c", bg: "#fff3e0", border: "#ffcc80",
        description: "EvalÃºa evidencias seudonimizadas (texto, imagen, cÃ³digo, JSON). Aplica rÃºbricas multi-criterio. Calcula Score y Gradiente de AutonomÃ­a. Realiza DiagnÃ³stico de Causa RaÃ­z ante fallos. Actualiza SkillMasteryAggregate en Orion-LD.",
        tech: "Anthropic SDK Â· OpenAI Â· Python",
        endpoints: [
          { method: "POST", path: "/api/v2/evaluate",                       desc: "EvalÃºa una evidencia de desempeÃ±o para una SC",             consumes: ["CONNECTOR_CENTRAL"],          produces: "score, gradiente_autonomia, diagnostico_causa_raiz, nueva_SC_recomendada" },
          { method: "GET",  path: "/api/v2/evaluations/{anon_id}",          desc: "Historial de evaluaciones del estudiante",                   consumes: ["CONNECTOR_CENTRAL","SGRAPH"], produces: "evaluations[] con score y feedback" },
          { method: "GET",  path: "/api/v2/evaluations/{anon_id}/{sc_id}",  desc: "EvaluaciÃ³n especÃ­fica de un estudiante para una SC",         consumes: ["CONNECTOR_CENTRAL"],          produces: "EvaluaciÃ³n detallada con diagnÃ³stico" },
          { method: "POST", path: "/api/v2/rubrics",                        desc: "Registra una nueva rÃºbrica en el sistema",                   consumes: ["PGEN","OPERATOR"],            produces: "rubric_id" },
        ],
        reads: ["POSTGRES","PGEN","LLM"], writes: ["POSTGRES","ORIONLD","SGRAPH"],
      },
      {
        id: "SYNTH", icon: "ğŸ”¬", title: "Synthetic Data Generator",
        subtitle: "GeneraciÃ³n de trazas y perfiles sintÃ©ticos para inicializaciÃ³n del grafo",
        color: "#33691e", bg: "#f1f8e9", border: "#aed581",
        description: "Genera estudiantes sintÃ©ticos con trazas de aprendizaje para poblar el grafo y validar el motor de recomendaciÃ³n. Produce perfiles de habilitaciÃ³n iniciales para bootstrapping del sistema en nuevos centros o nuevos ciclos formativos.",
        tech: "Python Â· Faker Â· NumPy",
        endpoints: [
          { method: "POST", path: "/api/v2/synth/students",   desc: "Genera N perfiles de estudiantes sintÃ©ticos",                       consumes: ["OPERATOR"],        produces: "synthetic_students.json" },
          { method: "POST", path: "/api/v2/synth/traces",     desc: "Genera trazas de navegaciÃ³n sintÃ©ticas sobre el grafo",             consumes: ["KSB","OPERATOR"],  produces: "traces[] para enriquecimiento del grafo" },
          { method: "POST", path: "/api/v2/synth/bootstrap",  desc: "Inicializa un ciclo formativo completo con datos sintÃ©ticos",       consumes: ["OPERATOR"],        produces: "Estado inicial completo del grafo" },
        ],
        reads: ["POSTGRES","KSB"], writes: ["KSB"],
      },
    ];

    const FILTER_OPTIONS = [
      { id: "ALL",               label: "Todos los mÃ³dulos" },
      { id: "CONNECTOR_CENTRAL", label: "âŸµ vÃ­a CONNECTOR_CENTRAL" },
      { id: "OPERATOR",          label: "âŸµ Operador" },
      { id: "ORIONLD",           label: "â†” Orion-LD" },
      { id: "POSTGRES",          label: "â†” PostgreSQL" },
      { id: "LLM",               label: "â†” LLM API" },
    ];

    function ModuleCard({ mod, isActive, onClick }) {
      return (
        <div onClick={onClick} style={{
          background: isActive ? mod.bg : "white",
          border: `2px solid ${isActive ? mod.color : mod.border}`,
          borderRadius: "12px", cursor: "pointer",
          transition: "all 0.2s ease",
          boxShadow: isActive ? `0 4px 20px ${mod.color}40` : "0 2px 8px rgba(0,0,0,0.08)",
          overflow: "hidden",
        }}>
          <div style={{
            background: isActive ? mod.color : "#f8f9fa",
            padding: "14px 18px", display: "flex", alignItems: "center", gap: "10px",
            borderBottom: `2px solid ${isActive ? mod.color : mod.border}`,
            transition: "all 0.2s ease",
          }}>
            <span style={{ fontSize: "22px" }}>{mod.icon}</span>
            <div>
              <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: "800", fontSize: "14px", color: isActive ? "white" : "#1a1a2e", letterSpacing: "-0.02em" }}>{mod.title}</div>
              <div style={{ fontSize: "10.5px", color: isActive ? "rgba(255,255,255,0.85)" : "#666", fontFamily: "'DM Sans', sans-serif" }}>{mod.subtitle}</div>
            </div>
            <div style={{ marginLeft: "auto", fontSize: "11px", fontWeight: "700",
              color: isActive ? "rgba(255,255,255,0.9)" : mod.color, fontFamily: "'DM Mono', monospace",
              background: isActive ? "rgba(255,255,255,0.2)" : mod.bg,
              padding: "2px 8px", borderRadius: "20px", border: `1px solid ${isActive ? "rgba(255,255,255,0.4)" : mod.border}`,
            }}>{mod.endpoints.length} endpoints</div>
          </div>
          <div style={{ padding: "14px 18px" }}>
            <p style={{ fontSize: "12px", lineHeight: "1.6", color: "#444", margin: "0 0 12px 0", fontFamily: "'DM Sans', sans-serif" }}>{mod.description}</p>
            <div style={{ marginBottom: "10px" }}>
              <span style={{ fontSize: "10px", fontWeight: "700", color: mod.color, fontFamily: "'DM Mono', monospace", letterSpacing: "0.06em", textTransform: "uppercase" }}>TECH STACK: </span>
              <span style={{ fontSize: "11px", color: "#555", fontFamily: "'DM Mono', monospace" }}>{mod.tech}</span>
            </div>
            <div style={{ fontSize: "10.5px", fontWeight: "700", color: "#888", fontFamily: "'DM Mono', monospace", letterSpacing: "0.08em", textTransform: "uppercase", marginBottom: "8px" }}>ENDPOINTS</div>
            <div style={{ display: "flex", flexDirection: "column", gap: "8px" }}>
              {mod.endpoints.map((ep, i) => (
                <div key={i} style={{ background: "#fafafa", border: "1px solid #eee", borderRadius: "8px", padding: "10px 12px", borderLeft: `3px solid ${mod.color}` }}>
                  <div style={{ display: "flex", alignItems: "center", gap: "8px", marginBottom: "4px", flexWrap: "wrap" }}>
                    <MethodBadge method={ep.method} />
                    <code style={{ fontSize: "11.5px", fontFamily: "'DM Mono', monospace", color: "#1a1a2e", fontWeight: "600", background: "#f0f0f0", padding: "1px 6px", borderRadius: "3px" }}>{ep.path}</code>
                  </div>
                  <p style={{ margin: "0 0 6px 0", fontSize: "11.5px", color: "#555", fontFamily: "'DM Sans', sans-serif", lineHeight: "1.4" }}>{ep.desc}</p>
                  <div>
                    <span style={{ fontSize: "10px", color: "#999", fontWeight: "600", fontFamily: "'DM Mono', monospace", textTransform: "uppercase", letterSpacing: "0.06em", marginRight: "6px" }}>CONSUME:</span>
                    {ep.consumes.map(c => <ConsumerBadge key={c} id={c} />)}
                  </div>
                  <div style={{ marginTop: "4px" }}>
                    <span style={{ fontSize: "10px", color: "#999", fontWeight: "600", fontFamily: "'DM Mono', monospace", textTransform: "uppercase", letterSpacing: "0.06em", marginRight: "6px" }}>PRODUCE:</span>
                    <span style={{ fontSize: "10.5px", color: "#666", fontFamily: "'DM Mono', monospace", fontStyle: "italic" }}>{ep.produces}</span>
                  </div>
                </div>
              ))}
            </div>
            {(mod.reads.length > 0 || mod.writes.length > 0) && (
              <div style={{ marginTop: "12px", display: "flex", gap: "12px", flexWrap: "wrap" }}>
                {mod.reads.length > 0 && (
                  <div>
                    <span style={{ fontSize: "10px", color: "#1565c0", fontWeight: "700", fontFamily: "'DM Mono', monospace", textTransform: "uppercase", letterSpacing: "0.06em" }}>READ â†— </span>
                    {mod.reads.map(r => <InfraTag key={r} id={r} />)}
                  </div>
                )}
                {mod.writes.length > 0 && (
                  <div>
                    <span style={{ fontSize: "10px", color: "#c62828", fontWeight: "700", fontFamily: "'DM Mono', monospace", textTransform: "uppercase", letterSpacing: "0.06em" }}>WRITE â†™ </span>
                    {mod.writes.map(w => <InfraTag key={w} id={w} />)}
                  </div>
                )}
              </div>
            )}
          </div>
        </div>
      );
    }

    function EACModules() {
      const [activeModule, setActiveModule] = useState(null);
      const [filter, setFilter] = useState("ALL");
      const filtered = filter === "ALL"
        ? MODULES_DATA
        : MODULES_DATA.filter(m =>
            m.endpoints.some(ep => ep.consumes.includes(filter)) ||
            m.reads.includes(filter) || m.writes.includes(filter)
          );

      return (
        <div style={{ flex: 1, overflowY: "auto" }}>
          {/* Filter bar */}
          <div style={{ padding: "16px 40px", borderBottom: "1px solid rgba(255,255,255,0.06)", display: "flex", gap: "6px", flexWrap: "wrap", background: "rgba(255,255,255,0.02)" }}>
            {FILTER_OPTIONS.map(f => (
              <button key={f.id} onClick={() => setFilter(f.id)} style={{
                padding: "6px 12px", borderRadius: "20px",
                border: `1px solid ${filter === f.id ? "#e91e63" : "rgba(255,255,255,0.2)"}`,
                background: filter === f.id ? "#e91e63" : "rgba(255,255,255,0.06)",
                color: filter === f.id ? "white" : "rgba(255,255,255,0.7)",
                cursor: "pointer", fontSize: "11px", fontWeight: "600",
                fontFamily: "'DM Mono', monospace", transition: "all 0.2s", letterSpacing: "0.02em",
              }}>{f.label}</button>
            ))}
          </div>

          {/* External entities */}
          <div style={{ background: "rgba(255,255,255,0.03)", borderBottom: "1px solid rgba(255,255,255,0.06)", padding: "10px 40px" }}>
            <div style={{ display: "flex", alignItems: "center", gap: "8px", flexWrap: "wrap" }}>
              <span style={{ color: "rgba(255,255,255,0.4)", fontSize: "10px", fontFamily: "'DM Mono', monospace", fontWeight: "700", textTransform: "uppercase", letterSpacing: "0.1em", marginRight: "8px" }}>Entidades externas al EAC:</span>
              {Object.entries(CONSUMERS).filter(([id]) => ["CONNECTOR_CENTRAL","ORIONLD","POSTGRES","LLM","OPERATOR","PROMETHEUS"].includes(id)).map(([id, c]) => (
                <span key={id} style={{ padding: "3px 10px", borderRadius: "4px", fontSize: "10.5px", fontWeight: "600", background: `${c.bg}22`, color: c.color, border: `1px solid ${c.color}55`, fontFamily: "'DM Mono', monospace" }}>{c.label}</span>
              ))}
            </div>
          </div>

          {/* Grid */}
          <div style={{ maxWidth: "1400px", margin: "0 auto", padding: "28px 40px" }}>
            {filtered.length === 0 && (
              <div style={{ textAlign: "center", padding: "60px", color: "rgba(255,255,255,0.3)", fontFamily: "'DM Mono', monospace" }}>No hay mÃ³dulos que interactÃºen con este filtro</div>
            )}
            <div style={{ display: "grid", gridTemplateColumns: "repeat(auto-fill, minmax(460px, 1fr))", gap: "20px" }}>
              {filtered.map(mod => (
                <ModuleCard key={mod.id} mod={mod} isActive={activeModule === mod.id}
                  onClick={() => setActiveModule(activeModule === mod.id ? null : mod.id)} />
              ))}
            </div>

            {/* Legend */}
            <div style={{ marginTop: "40px", background: "rgba(255,255,255,0.04)", border: "1px solid rgba(255,255,255,0.08)", borderRadius: "12px", padding: "20px 24px" }}>
              <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: "800", fontSize: "13px", color: "rgba(255,255,255,0.7)", marginBottom: "14px" }}>Leyenda de Consumidores</div>
              <div style={{ display: "flex", flexWrap: "wrap", gap: "10px" }}>
                {Object.entries(CONSUMERS).map(([id, c]) => (
                  <div key={id} style={{ display: "flex", alignItems: "center", gap: "6px" }}>
                    <span style={{ width: "10px", height: "10px", borderRadius: "50%", background: c.color, flexShrink: 0 }}></span>
                    <span style={{ fontSize: "11px", color: "rgba(255,255,255,0.6)", fontFamily: "'DM Mono', monospace" }}>{c.label}</span>
                  </div>
                ))}
              </div>
              <div style={{ marginTop: "16px", display: "flex", gap: "16px", flexWrap: "wrap" }}>
                {Object.entries(METHOD_COLORS).map(([method, c]) => (
                  <div key={method} style={{ display: "flex", alignItems: "center", gap: "6px" }}>
                    <span style={{ padding: "1px 7px", borderRadius: "3px", fontSize: "10px", fontWeight: "800", background: c.bg, color: c.text, border: `1.5px solid ${c.border}`, fontFamily: "'DM Mono', monospace" }}>{method}</span>
                    <span style={{ fontSize: "11px", color: "rgba(255,255,255,0.5)", fontFamily: "'DM Sans', sans-serif" }}>
                      {method === "GET" && "Consulta (sin efectos)"}
                      {method === "POST" && "CreaciÃ³n / acciÃ³n"}
                      {method === "PUT" && "ActualizaciÃ³n completa"}
                      {method === "PATCH" && "ActualizaciÃ³n parcial"}
                      {method === "DELETE" && "EliminaciÃ³n"}
                    </span>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
      );
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // TAB 2 â€” DIAGRAMA DE DEPENDENCIAS (eac_flow)
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    const SVG_W = 1060, SVG_H = 620;
    const NODE_W = 180, NODE_H = 52;

    const FLOW_NODES = {
      OPERATOR: { x: 20,  y: 40,  icon: "ğŸ”§", label: "Operador",               sub: "externo al EAC",              color: "#546e7a", bg: "#eceff1", kind: "external" },
      CONN:     { x: 400, y: 30,  icon: "ğŸ”—", label: "CONNECTOR_CENTRAL",       sub: "API Gateway Â· ODRL",          color: "#c62828", bg: "#ffebee", kind: "external" },
      LLM:      { x: 800, y: 40,  icon: "ğŸ¤–", label: "LLM API",                 sub: "Claude Â· GPT-4",              color: "#e65100", bg: "#fff3e0", kind: "external" },
      SYNTH:    { x: 20,  y: 300, icon: "ğŸ”¬", label: "Synthetic Data Gen.",     sub: "bootstrap Â· trazas",          color: "#558b2f", bg: "#f1f8e9", kind: "internal" },
      KSB:      { x: 215, y: 220, icon: "ğŸ“", label: "Knowledge Space Builder", sub: "DAG de habilidades",          color: "#00695c", bg: "#e0f2f1", kind: "internal" },
      SGRAPH:   { x: 430, y: 300, icon: "ğŸ•¸ï¸", label: "Skill Graph Manager",    sub: "Perfil HabilitaciÃ³n Â· ZDP",   color: "#283593", bg: "#e8eaf6", kind: "internal" },
      RUBRIC:   { x: 645, y: 220, icon: "ğŸ“", label: "Rubric Evaluator",        sub: "score Â· Gradiente AutonomÃ­a", color: "#bf360c", bg: "#fff3e0", kind: "internal" },
      PGEN:     { x: 860, y: 300, icon: "ğŸ“‹", label: "Problem Generator",       sub: "genera SC Â· rÃºbricas",        color: "#6a1b9a", bg: "#f3e5f5", kind: "internal" },
      REC:      { x: 453, y: 420, icon: "ğŸ¯", label: "Recommendation Engine",   sub: "Outer Fringe Â· ZDP",          color: "#1565c0", bg: "#e3f2fd", kind: "internal" },
      POSTGRES: { x: 150, y: 530, icon: "ğŸ˜", label: "PostgreSQL",              sub: "habilitacion Â· SC Â· history", color: "#4e342e", bg: "#efebe9", kind: "storage" },
      ORIONLD:  { x: 700, y: 530, icon: "ğŸŒ", label: "Orion-LD",               sub: "NGSI-LD Â· SkillMastery",      color: "#00838f", bg: "#e0f7fa", kind: "storage" },
    };

    const EDGES_DATA = [
      { from: "OPERATOR", to: "SYNTH",    label: "dispara bootstrap",           flow: "init" },
      { from: "OPERATOR", to: "KSB",      label: "POST /graph/build",           flow: "init" },
      { from: "SYNTH",    to: "KSB",      label: "POST /graph/enrich",          flow: "init" },
      { from: "KSB",      to: "SGRAPH",   label: "GET /graph/curriculum",       flow: "init" },
      { from: "CONN",     to: "RUBRIC",   label: "POST /api/v2/evaluate",       flow: "eval" },
      { from: "RUBRIC",   to: "SGRAPH",   label: "PUT /students/{id}/profile",  flow: "eval" },
      { from: "RUBRIC",   to: "ORIONLD",  label: "PATCH SkillMasteryAggregate", flow: "eval" },
      { from: "RUBRIC",   to: "LLM",      label: "prompt evaluaciÃ³n",           flow: "eval" },
      { from: "RUBRIC",   to: "PGEN",     label: "GET /sc/{id} (rÃºbrica)",      flow: "eval" },
      { from: "CONN",     to: "REC",      label: "GET /recommendation Â· /panel",flow: "rec"  },
      { from: "CONN",     to: "SGRAPH",   label: "GET /profile Â· /history",     flow: "rec"  },
      { from: "SGRAPH",   to: "REC",      label: "outer-fringe Â· perfil",       flow: "rec"  },
      { from: "REC",      to: "POSTGRES", label: "consulta estados",            flow: "rec"  },
      { from: "CONN",     to: "PGEN",     label: "POST /sc/generate Â· GET /sc", flow: "gen"  },
      { from: "REC",      to: "PGEN",     label: "sc_id seleccionada",          flow: "gen"  },
      { from: "PGEN",     to: "LLM",      label: "prompt SC Â· rÃºbrica",         flow: "gen"  },
      { from: "SGRAPH",   to: "POSTGRES", label: "R/W habilitacion Â· history",  flow: "storage" },
      { from: "SGRAPH",   to: "ORIONLD",  label: "R/W SkillMasteryAggregate",   flow: "storage" },
      { from: "KSB",      to: "ORIONLD",  label: "Lee/Actualiza VocationalSkill",flow: "storage"},
      { from: "PGEN",     to: "POSTGRES", label: "almacena SC Â· rÃºbricas",      flow: "storage" },
    ];

    const FLOWS_META = [
      { id: "all",     label: "Todas las dependencias",  color: "#555",    icon: "â¬¡" },
      { id: "init",    label: "InicializaciÃ³n del grafo", color: "#558b2f", icon: "ğŸ”¬" },
      { id: "eval",    label: "Flujo de evaluaciÃ³n",     color: "#bf360c", icon: "ğŸ“" },
      { id: "rec",     label: "Flujo de recomendaciÃ³n",  color: "#1565c0", icon: "ğŸ¯" },
      { id: "gen",     label: "GeneraciÃ³n de SC",        color: "#6a1b9a", icon: "ğŸ¤–" },
      { id: "storage", label: "Persistencia",            color: "#4e342e", icon: "ğŸ—„ï¸" },
    ];

    const FLOW_COLORS = {
      init:    "#4caf50",
      eval:    "#f44336",
      rec:     "#2196f3",
      gen:     "#9c27b0",
      storage: "#795548",
    };

    function getNodeCenter(id) {
      const n = FLOW_NODES[id];
      return { x: n.x + NODE_W / 2, y: n.y + NODE_H / 2 };
    }

    function edgePath(fromId, toId, offset) {
      const a = getNodeCenter(fromId);
      const b = getNodeCenter(toId);
      const dx = b.x - a.x, dy = b.y - a.y;
      const len = Math.sqrt(dx * dx + dy * dy) || 1;
      const ux = dx / len, uy = dy / len;
      const ox = -uy * offset * 8, oy = ux * offset * 8;
      const pad = 28;
      const sx = a.x + ux * pad + ox, sy = a.y + uy * pad + oy;
      const ex = b.x - ux * pad + ox, ey = b.y - uy * pad + oy;
      const mx = (sx + ex) / 2 + ox * 2, my = (sy + ey) / 2 + oy * 2;
      return { path: `M ${sx} ${sy} Q ${mx} ${my} ${ex} ${ey}`, mx, my };
    }

    function FlowArrow({ edge, idx, activeFlow, hoveredEdge, setHoveredEdge }) {
      const isActive = activeFlow === "all" || edge.flow === activeFlow;
      const isHovered = hoveredEdge === idx;
      const color = FLOW_COLORS[edge.flow];
      const { path, mx, my } = edgePath(edge.from, edge.to, idx % 3 - 1);
      const markId = `arr-${edge.flow}-${idx}`;
      return (
        <g opacity={isActive ? 1 : 0.08} style={{ cursor: "pointer" }}
          onMouseEnter={() => setHoveredEdge(idx)}
          onMouseLeave={() => setHoveredEdge(null)}>
          <defs>
            <marker id={markId} markerWidth="8" markerHeight="8" refX="6" refY="3" orient="auto">
              <path d="M0,0 L0,6 L8,3 z" fill={color} />
            </marker>
          </defs>
          <path d={path} fill="none" stroke="transparent" strokeWidth="12" />
          <path d={path} fill="none" stroke={color}
            strokeWidth={isHovered ? 3 : isActive ? 2 : 1.5}
            strokeDasharray={edge.flow === "storage" ? "5,3" : "none"}
            markerEnd={`url(#${markId})`} />
          {(isActive || isHovered) && (
            <text x={mx} y={my - 5} textAnchor="middle" style={{
              fontSize: "8.5px", fontFamily: "'DM Mono', monospace",
              fill: color, fontWeight: "600",
              stroke: "rgba(13,17,23,0.85)", strokeWidth: "3",
              paintOrder: "stroke", pointerEvents: "none",
            }}>{edge.label}</text>
          )}
        </g>
      );
    }

    function FlowNode({ id, activeFlow, hoveredNode, setHoveredNode, selectedNode, setSelectedNode }) {
      const n = FLOW_NODES[id];
      const isSelected = selectedNode === id;
      const isHovered = hoveredNode === id;
      const isConnected = selectedNode && EDGES_DATA.some(e =>
        (e.from === selectedNode && e.to === id) || (e.to === selectedNode && e.from === id)
      );
      const dim = selectedNode && !isSelected && !isConnected;
      return (
        <g transform={`translate(${n.x}, ${n.y})`} style={{ cursor: "pointer" }}
          onMouseEnter={() => setHoveredNode(id)}
          onMouseLeave={() => setHoveredNode(null)}
          onClick={() => setSelectedNode(selectedNode === id ? null : id)}>
          <rect x="2" y="3" width={NODE_W} height={NODE_H} rx="10" fill="rgba(0,0,0,0.15)" />
          <rect x="0" y="0" width={NODE_W} height={NODE_H} rx="10"
            fill={isSelected ? n.color : (isHovered ? n.bg : (n.kind === "external" ? "#fff8f0" : n.kind === "storage" ? "#f5f5f5" : "white"))}
            stroke={isSelected ? n.color : (isConnected ? n.color : (isHovered ? n.color : "#e0e0e0"))}
            strokeWidth={isSelected || isConnected ? 2 : 1}
            opacity={dim ? 0.25 : 1} />
          <rect x="0" y="0" width="4" height={NODE_H} rx="2" fill={n.color} opacity={dim ? 0.15 : 0.7} />
          <text x="16" y="22" style={{ fontSize: "15px", pointerEvents: "none" }}>{n.icon}</text>
          <text x="36" y="22" style={{ fontSize: "10.5px", fontFamily: "'Syne', sans-serif", fontWeight: "700", fill: isSelected ? "white" : n.color, pointerEvents: "none" }}>{n.label}</text>
          <text x="10" y="38" style={{ fontSize: "8.5px", fontFamily: "'DM Mono', monospace", fill: isSelected ? "rgba(255,255,255,0.8)" : "#888", pointerEvents: "none" }}>{n.sub}</text>
          {n.kind === "external" && (
            <>
              <rect x={NODE_W - 46} y="4" width="40" height="13" rx="6" fill={n.color} opacity="0.15" />
              <text x={NODE_W - 26} y="14" textAnchor="middle" style={{ fontSize: "7px", fontFamily: "'DM Mono', monospace", fill: n.color, fontWeight: "700", pointerEvents: "none" }}>EXT</text>
            </>
          )}
          {n.kind === "storage" && (
            <text x={NODE_W - 14} y="14" style={{ fontSize: "9px", pointerEvents: "none" }}>ğŸ’¾</text>
          )}
        </g>
      );
    }

    function EACFlow() {
      const [activeFlow, setActiveFlow] = useState("all");
      const [hoveredEdge, setHoveredEdge] = useState(null);
      const [hoveredNode, setHoveredNode] = useState(null);
      const [selectedNode, setSelectedNode] = useState(null);

      const nodeEdgesOut = selectedNode ? EDGES_DATA.filter(e => e.from === selectedNode) : [];
      const nodeEdgesIn  = selectedNode ? EDGES_DATA.filter(e => e.to   === selectedNode) : [];

      return (
        <div style={{ flex: 1, display: "flex", flexDirection: "column", overflow: "hidden" }}>
          {/* Flow filter */}
          <div style={{ padding: "12px 32px", borderBottom: "1px solid rgba(255,255,255,0.06)", display: "flex", gap: "6px", flexWrap: "wrap", background: "rgba(255,255,255,0.02)" }}>
            {FLOWS_META.map(f => (
              <button key={f.id} onClick={() => { setActiveFlow(f.id); setSelectedNode(null); }} style={{
                padding: "5px 12px", borderRadius: "20px",
                border: `1px solid ${activeFlow === f.id ? f.color : "rgba(255,255,255,0.12)"}`,
                background: activeFlow === f.id ? `${f.color}22` : "rgba(255,255,255,0.04)",
                color: activeFlow === f.id ? f.color : "rgba(255,255,255,0.55)",
                cursor: "pointer", fontSize: "11px", fontWeight: "600",
                fontFamily: "'DM Mono', monospace", transition: "all 0.18s",
                display: "flex", alignItems: "center", gap: "5px",
              }}>
                <span>{f.icon}</span>
                <span>{f.label}</span>
                {f.id !== "all" && (
                  <span style={{ background: `${f.color}33`, color: f.color, borderRadius: "10px", padding: "0 6px", fontSize: "9px", fontWeight: "800" }}>
                    {EDGES_DATA.filter(e => e.flow === f.id).length}
                  </span>
                )}
              </button>
            ))}
          </div>

          {/* Main area */}
          <div style={{ display: "flex", flex: 1, overflow: "hidden" }}>
            {/* SVG */}
            <div style={{ flex: 1, overflow: "auto", padding: "24px", display: "flex", justifyContent: "center" }}>
              <svg width={SVG_W} height={SVG_H} style={{ background: "rgba(255,255,255,0.02)", borderRadius: "16px", border: "1px solid rgba(255,255,255,0.06)", minWidth: SVG_W }}>
                <defs>
                  <pattern id="grid" width="40" height="40" patternUnits="userSpaceOnUse">
                    <path d="M 40 0 L 0 0 0 40" fill="none" stroke="rgba(255,255,255,0.025)" strokeWidth="0.5"/>
                  </pattern>
                </defs>
                <rect width={SVG_W} height={SVG_H} fill="url(#grid)" rx="16"/>

                {/* Zone labels */}
                {[
                  { x: 12, y: 15, label: "ENTIDADES EXTERNAS" },
                  { x: 12, y: 180, label: "MÃ“DULOS EAC" },
                  { x: 12, y: 390, label: "MOTOR DE DECISIÃ“N" },
                  { x: 12, y: 515, label: "PERSISTENCIA" },
                ].map(z => (
                  <text key={z.y} x={z.x} y={z.y} style={{ fontSize: "8px", fill: "rgba(255,255,255,0.2)", fontFamily: "'DM Mono', monospace", fontWeight: "700", letterSpacing: "0.1em" }}>{z.label}</text>
                ))}

                {[170, 380, 505].map(y => (
                  <line key={y} x1="8" y1={y} x2={SVG_W - 8} y2={y} stroke="rgba(255,255,255,0.06)" strokeWidth="1" strokeDasharray="4,4"/>
                ))}

                {/* Edges */}
                {EDGES_DATA.map((edge, i) => (
                  <FlowArrow key={i} edge={edge} idx={i} activeFlow={activeFlow}
                    hoveredEdge={hoveredEdge} setHoveredEdge={setHoveredEdge} />
                ))}

                {/* Nodes */}
                {Object.keys(FLOW_NODES).map(id => (
                  <FlowNode key={id} id={id} activeFlow={activeFlow}
                    hoveredNode={hoveredNode} setHoveredNode={setHoveredNode}
                    selectedNode={selectedNode} setSelectedNode={setSelectedNode} />
                ))}

                {/* Legend */}
                <g transform={`translate(${SVG_W - 148}, ${SVG_H - 122})`}>
                  <rect width="140" height="114" rx="8" fill="rgba(0,0,0,0.55)" stroke="rgba(255,255,255,0.1)" strokeWidth="1"/>
                  <text x="8" y="16" style={{ fontSize: "8px", fill: "rgba(255,255,255,0.5)", fontFamily: "'DM Mono', monospace", fontWeight: "700", letterSpacing: "0.08em" }}>LEYENDA</text>
                  {Object.entries(FLOW_COLORS).map(([flow, color], i) => {
                    const f = FLOWS_META.find(f => f.id === flow);
                    return (
                      <g key={flow} transform={`translate(8, ${26 + i * 17})`}>
                        <line x1="0" y1="5" x2="18" y2="5" stroke={color} strokeWidth="2" strokeDasharray={flow === "storage" ? "4,2" : "none"}/>
                        <text x="24" y="9" style={{ fontSize: "8.5px", fill: "rgba(255,255,255,0.6)", fontFamily: "'DM Mono', monospace" }}>{f?.label}</text>
                      </g>
                    );
                  })}
                </g>

                <text x={SVG_W / 2} y={SVG_H - 6} textAnchor="middle" style={{ fontSize: "9px", fill: "rgba(255,255,255,0.2)", fontFamily: "'DM Mono', monospace" }}>
                  Haz clic en un nodo Â· Pasa el cursor por una arista
                </text>
              </svg>
            </div>

            {/* Info panel */}
            <div style={{ width: "280px", flexShrink: 0, borderLeft: "1px solid rgba(255,255,255,0.07)", background: "rgba(255,255,255,0.02)", overflowY: "auto", padding: "20px 16px", display: "flex", flexDirection: "column", gap: "12px" }}>
              {selectedNode ? (() => {
                const n = FLOW_NODES[selectedNode];
                return (
                  <>
                    <div>
                      <div style={{ display: "flex", alignItems: "center", gap: "8px", marginBottom: "6px" }}>
                        <span style={{ fontSize: "22px" }}>{n.icon}</span>
                        <div>
                          <div style={{ fontFamily: "'Syne', sans-serif", fontWeight: "800", fontSize: "13px", color: n.color }}>{n.label}</div>
                          <div style={{ fontSize: "9.5px", color: "rgba(255,255,255,0.4)", fontFamily: "'DM Mono', monospace" }}>{n.sub}</div>
                        </div>
                      </div>
                      <div style={{ padding: "4px 8px", borderRadius: "4px", background: `${n.color}22`, border: `1px solid ${n.color}44`, display: "inline-block" }}>
                        <span style={{ fontSize: "9px", fontWeight: "700", color: n.color, fontFamily: "'DM Mono', monospace", textTransform: "uppercase" }}>
                          {n.kind === "external" ? "Entidad externa" : n.kind === "storage" ? "Infraestructura" : "MÃ³dulo EAC"}
                        </span>
                      </div>
                    </div>
                    {nodeEdgesIn.length > 0 && (
                      <div>
                        <div style={{ fontSize: "9px", fontWeight: "700", color: "rgba(255,255,255,0.35)", fontFamily: "'DM Mono', monospace", textTransform: "uppercase", letterSpacing: "0.1em", marginBottom: "6px" }}>â† RECIBE DE</div>
                        {nodeEdgesIn.map((e, i) => (
                          <div key={i} style={{ padding: "7px 10px", marginBottom: "5px", borderRadius: "6px", background: `${FLOW_COLORS[e.flow]}15`, borderLeft: `3px solid ${FLOW_COLORS[e.flow]}` }}>
                            <div style={{ fontSize: "10px", fontWeight: "700", color: FLOW_COLORS[e.flow], fontFamily: "'Syne', sans-serif" }}>{FLOW_NODES[e.from].label}</div>
                            <div style={{ fontSize: "9px", color: "rgba(255,255,255,0.5)", fontFamily: "'DM Mono', monospace", marginTop: "2px" }}>{e.label}</div>
                          </div>
                        ))}
                      </div>
                    )}
                    {nodeEdgesOut.length > 0 && (
                      <div>
                        <div style={{ fontSize: "9px", fontWeight: "700", color: "rgba(255,255,255,0.35)", fontFamily: "'DM Mono', monospace", textTransform: "uppercase", letterSpacing: "0.1em", marginBottom: "6px" }}>â†’ ENVÃA A</div>
                        {nodeEdgesOut.map((e, i) => (
                          <div key={i} style={{ padding: "7px 10px", marginBottom: "5px", borderRadius: "6px", background: `${FLOW_COLORS[e.flow]}15`, borderLeft: `3px solid ${FLOW_COLORS[e.flow]}` }}>
                            <div style={{ fontSize: "10px", fontWeight: "700", color: FLOW_COLORS[e.flow], fontFamily: "'Syne', sans-serif" }}>{FLOW_NODES[e.to].label}</div>
                            <div style={{ fontSize: "9px", color: "rgba(255,255,255,0.5)", fontFamily: "'DM Mono', monospace", marginTop: "2px" }}>{e.label}</div>
                          </div>
                        ))}
                      </div>
                    )}
                    <button onClick={() => setSelectedNode(null)} style={{ marginTop: "auto", padding: "8px", borderRadius: "8px", border: "1px solid rgba(255,255,255,0.1)", background: "rgba(255,255,255,0.05)", color: "rgba(255,255,255,0.5)", cursor: "pointer", fontSize: "11px", fontFamily: "'DM Mono', monospace" }}>
                      Limpiar selecciÃ³n âœ•
                    </button>
                  </>
                );
              })() : (
                <div style={{ color: "rgba(255,255,255,0.25)", fontSize: "11px", fontFamily: "'DM Mono', monospace", lineHeight: "1.7", paddingTop: "8px" }}>
                  <div style={{ fontSize: "22px", marginBottom: "10px", opacity: 0.5 }}>ğŸ‘†</div>
                  <strong style={{ color: "rgba(255,255,255,0.4)" }}>Selecciona un nodo</strong>
                  <br/>para ver quÃ© mÃ³dulos lo consumen y cuÃ¡les dependen de Ã©l.
                  <br/><br/>
                  <strong style={{ color: "rgba(255,255,255,0.4)" }}>Filtra por flujo</strong>
                  <br/>usando los botones superiores para aislar cada camino funcional.
                  <br/><br/>
                  <strong style={{ color: "rgba(255,255,255,0.4)" }}>Pasa el cursor</strong>
                  <br/>sobre una arista para ver el endpoint o mensaje concreto.
                </div>
              )}
            </div>
          </div>
        </div>
      );
    }

    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    // ROOT â€” Tab switcher
    // â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

    function EACCentral() {
      const [tab, setTab] = useState("modules");

      const TABS = [
        { id: "modules", label: "ğŸ“¦ MÃ³dulos y Endpoints" },
        { id: "flow",    label: "ğŸ”€ Diagrama de Dependencias" },
      ];

      return (
        <div style={{
          height: "100vh", display: "flex", flexDirection: "column",
          background: "linear-gradient(135deg, #0f0c29 0%, #1a1a2e 40%, #16213e 100%)",
          fontFamily: "'DM Sans', sans-serif",
        }}>
          <style>{`@import url('https://fonts.googleapis.com/css2?family=Syne:wght@700;800&family=DM+Sans:ital,wght@0,400;0,500;0,600;1,400&family=DM+Mono:wght@400;500;600&display=swap');`}</style>

          {/* Header */}
          <div style={{
            background: "linear-gradient(90deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",
            borderBottom: "1px solid rgba(255,255,255,0.08)",
            padding: "0 40px",
            flexShrink: 0,
          }}>
            {/* Title row */}
            <div style={{ display: "flex", alignItems: "center", gap: "12px", paddingTop: "20px", paddingBottom: "16px", flexWrap: "wrap" }}>
              <div style={{
                background: "linear-gradient(135deg, #e91e63, #1976d2)",
                borderRadius: "8px", width: "32px", height: "32px",
                display: "flex", alignItems: "center", justifyContent: "center", fontSize: "16px",
              }}>âš™ï¸</div>
              <div>
                <h1 style={{ fontFamily: "'Syne', sans-serif", fontWeight: "800", fontSize: "22px", color: "white", margin: 0, letterSpacing: "-0.03em" }}>
                  Backend EAC â€” Nodo Central
                </h1>
                <p style={{ color: "rgba(255,255,255,0.5)", fontSize: "12px", margin: 0, fontFamily: "'DM Mono', monospace" }}>
                  VOCATIONAL FEDERATED DATASPACE Â· {MODULES_DATA.length} mÃ³dulos Â· {MODULES_DATA.reduce((a, m) => a + m.endpoints.length, 0)} endpoints Â· {EDGES_DATA.length} dependencias
                </p>
              </div>
            </div>

            {/* Tabs */}
            <div style={{ display: "flex", gap: 0 }}>
              {TABS.map(t => (
                <button key={t.id} onClick={() => setTab(t.id)} style={{
                  padding: "10px 24px",
                  border: "none",
                  borderBottom: tab === t.id ? "3px solid #e91e63" : "3px solid transparent",
                  background: "transparent",
                  color: tab === t.id ? "#e91e63" : "rgba(255,255,255,0.45)",
                  cursor: "pointer", fontSize: "12px", fontWeight: "700",
                  fontFamily: "'DM Mono', monospace", transition: "all 0.15s", letterSpacing: "0.02em",
                }}>{t.label}</button>
              ))}
            </div>
          </div>

          {/* Content */}
          <div style={{ flex: 1, overflow: "hidden", display: "flex", flexDirection: "column" }}>
            {tab === "modules" ? <EACModules /> : <EACFlow />}
          </div>
        </div>
      );
    }

    const root = ReactDOM.createRoot(document.getElementById("root"));
    root.render(<EACCentral />);
  </script>
</body>
</html>
